// Script:	DemoSpeedTest.txt
// 
// Purpose:	
//	  Check if system samples the desired number of AD with the desired sample rate
//    Possible sampling errors are detected easily and immediately by using ramps
//    Different ramp times allow to check multiple closely spaced sample rates
//		 1108.8 ms allows SmpInt  10,12,14,15,16,18,20,21,22,24,25,28,30,32,36,40 us
//		 1801.8 ms allows SmpInt  10,12,14,15,16,18,20,21,22,24,25,26,28,30,36,40 us
//	 	  982.8 ms allows SmpInt  10,12,14,15,16,18,20,21,24,25,26,27,28,30,36,40 us
// Usage:	
//		- Copy this script using 'Save as' using a name which may include the SmpInt
//		- Edit the script by selecting the desired AD channels, telegraph channels,
//			sample interval and ramp time
//		- Adjust the number frames so that the total duration approximately matches
//			your real protocol or use integral multiples of the given ramp time 	 
//			If you increase the number of frames you will have to decrease the 
//			automatic increment proportionally to avoid an amplitude overrange
//		- Connect DAC0 to all used ADC channels, connect telegraph channel(s) to the
//			AxoPatch or another suitable source
//	To achieve maximum speed:
//		- Turn (most or all) acquisition windows off, turn 'timing statistics' on, 
//		- Turn  'Acq windows' 	 'Display all data even when lagging'	off 
//		- Turn  'Acq windows' 	 'High resolution during acquisition'	off 
//		- Turn  'Miscellaneous' 'Quick check (after acq)'				on
//		- Turn  'Miscellaneous' 'Show timing statistics'				on
//		- 'Start'  the acquisition
//			Watch out for warnings or errors displayed in Igors history window
//			Watch the 'Duty' indicator, it should stay below 80%
//	After the acquistion:
//		- Look for irregularities in the 'Quick check' window 
//		- Execute 'Miscellaneous' 'Display raw data'   and look for irregularities
//		- Execute 'ReadCfs' , 'Protocol', 'Current Acq'  and look for irregularities				

PULSE	
Protocol:	Name	= "DemoSpeedTest25us"
Dac:		Chan = 0;		SmpInt = 25; Gain = 1
Adc:		Chan = 0;		SmpInt = 25; TGChan=5
Adc:		Chan = 2;		SmpInt = 25; TGChan=6

Frames:	N	=100
Sweeps:	N	= 1         
Ramp:	Dac	= 0,  1108.8;	Amp	= -10000,1,100 // ramp time must match sample intervl  
Ramp:	Dac	= 0,  1108.8;	Amp	=    0
EndSweep
EndFrame 

